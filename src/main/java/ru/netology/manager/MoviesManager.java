// Пакет, содержащий менеджер для работы с фильмами
package ru.netology.manager;

/**
 * Класс MoviesManager управляет коллекцией фильмов.
 * Предоставляет возможности:
 * 1. Добавление новых фильмов
 * 2. Получение всех фильмов в порядке добавления
 * 3. Получение последних добавленных фильмов в обратном порядке
 * Особенности:
 * - Поддерживает настраиваемый лимит для отображения последних фильмов
 * - Сохраняет обратную совместимость через конструктор по умолчанию
 * - Динамически расширяет массив при добавлении новых фильмов
 */
public class MoviesManager {
    /**
     * Массив для хранения названий фильмов.
     * Изначально создается пустым (длина 0).
     * При каждом добавлении нового фильма создается новый массив
     * на 1 элемент больше предыдущего.
     */
    String[] movies = new String[0];

    /**
     * Лимит количества фильмов, возвращаемых методом findLast().
     * Определяет, сколько последних добавленных фильмов будет показано.
     * Если фильмов меньше лимита, возвращаются все имеющиеся фильмы.
     */
    int limit;

    /**
     * Конструктор по умолчанию.
     * Создает менеджер с лимитом 5 последних фильмов.
     * Это значение выбрано как наиболее часто используемое в интерфейсах.
     */
    public MoviesManager() {
        this.limit = 5; // Значение по умолчанию
    }

    /**
     * Конструктор с настраиваемым лимитом.
     * Позволяет создать менеджер с указанным количеством
     * последних фильмов для отображения.
     *
     * @param limit количество последних фильмов для отображения.
     *              Должно быть положительным числом.
     *              Если передано отрицательное значение или 0,
     *              это может привести к некорректной работе метода findLast().
     */
    public MoviesManager(int limit) {
        this.limit = limit;
    }

    /**
     * Добавляет новый фильм в коллекцию.
     * Создает новый массив на 1 элемент больше текущего,
     * копирует все существующие фильмы и добавляет новый в конец.
     * @param movie название фильма для добавления.
     *              Не должно быть null (в текущей реализации нет проверки).
     */
    public void add(String movie) {
        // Создаем временный массив на 1 элемент больше текущего
        String[] tmp = new String[movies.length + 1];

        // Копируем все существующие фильмы в новый массив
        for (int i = 0; i < movies.length; i++) {
            tmp[i] = movies[i];
        }

        // Добавляем новый фильм в конец массива
        tmp[tmp.length - 1] = movie;

        // Заменяем старый массив новым
        movies = tmp;
    }

    /**
     * Возвращает все фильмы в порядке их добавления.
     * @return массив всех фильмов. Если фильмов нет, возвращается пустой массив.
     *         Возвращается именно копия ссылки на внутренний массив,
     *         поэтому изменения в возвращаемом массиве могут повлиять на внутреннее состояние.
     */
    public String[] findAll() {
        return movies; // Возвращаем ссылку на внутренний массив
    }

    /**
     * Возвращает последние добавленные фильмы в обратном порядке
     * (самый последний добавленный фильм будет первым в массиве).
     * Логика работы:
     * 1. Если общее количество фильмов меньше лимита, возвращаются все фильмы
     * 2. Если фильмов больше или равно лимиту, возвращаются только последние 'limit' фильмов
     * @return массив последних фильмов в обратном порядке хронологии добавления.
     */
    public String[] findLast() {
        // Определяем длину результирующего массива
        int resultLength;
        if (movies.length < limit) {
            // Если фильмов меньше лимита, берем все фильмы
            resultLength = movies.length;
        } else {
            // Иначе берем только последние 'limit' фильмов
            resultLength = limit;
        }

        // Создаем массив для результата
        String[] result = new String[resultLength];

        // Заполняем массив в обратном порядке
        for (int i = 0; i < resultLength; i++) {
            // movies.length - 1 - i: начинаем с последнего элемента и движемся к началу
            result[i] = movies[movies.length - 1 - i];
        }

        return result;
    }
}